# מזל טוב שרמןןןןן

&#x202b;
[מזל טוב מקמינקא!!](WhatsApp Video 2020-04-22 at 15.51.05.mp4)

&#x202b;
מזל טוב שרמן!!! 18 זה לא צחוק😝 תמשיך להיות חבר טוב ובן אדם שכיף להיות איתו. חוץ מזה נאחל לך חיים מאושרים, בעז"ה תאכל עוד הרבה קליק אדום ותצליח להתמודד עם קמינקא😂
&#x202b;
מזל טוב אחי🎉🎊🥳
> יואב סימן טוב

&#x202b;
מזל טוב שרמן🎉
&#x202b;   
מלא אושר בריאות ושמחה.   
&#x202b;
שתמשיך להיות כמו שאתה - חכם, מתעניין, נחמד, ושנמשיך לשבור את הראש על ctfים יחד. 
> עומרי

&#x202b;
מזל טוב שרמן יצעיר! שתצליח בכל מה שתרצה, בצופים, באוניברסיטה, בבית ספר... שתמיד יהיה לך כיף וקל בכל מה שתעשה ותמיד תהיה מוקף באנשים אהובים
> יואב כרמל

&#x202b;
   שרמן האחד והיחיד, נסיך צדיק ואח שלי
&#x202b;
מזל טובבבב אוהב אותך מלא!!!   
&#x202b;
סוף סוף אתה חוקי ואנחנו יכולים להשתכר בלי שעמית תכעס עלינו, אני מאחל לך את כל הטוב שבעולם שתמשיך להיות מתכנת על ושתגיע לאיזו יחידה שאתה רוצה, שתמשיך להיות הטרמפיסט האהוב עליי ושתהנה בכל שנייה בחיים שלך!   
&#x202b;
מת עלייך❤️❤️❤️
> גולדי

&#x202b;
שרמן,
אתה בין בני האדם החכמים, מצחיקים, מוכשרים, שותפים נהדרים למתקדם, וטובים בctf שאני מכירה! תמשיך להיות מי שאתה לנצח ואל תשתנה לעולם. מבטיחה לקנות לך קליק אדום שנצא. 
&#x202b;
ומקווה שנהנית מהctf!!!
> עמית ניר

&#x202b;
מזל טוב שרמן!! 
&#x202b;   
אתה אחד האנשים החכמים שאני מכיר, תמיד כיף ממש לדבר ולצחוק איתך על הכל,
&#x202b;   
תישאר כמו שאתה אח יקר
> ליפשיץ

&#x202b;
מזל טוב שרמן! מאחל לך עד 120 ארגזים מלאים של קליק אדום
> נועם יעקב

&#x202b;
מזל דוב שרמן!!!  
&#x202b;
אתה חבר טוב ותמיד כיף להיות איתך ולדבר איתך. אתה מצחיק ותמיד מלא שמחת חיים (חוץ מאחרי מייל מקמינקא), ואני ממש שמח ללמוד איתך. מאחל לך הרבה בריאות ואושר.  
&#x202b;
אוהב,   
![bear](bear_ido.jpeg)   
> עדו

&#x202b;
שרמן אח יקר, מזל טוב שיהיה לך, תמשיך להיות מי שאתה (לאכול קליק אדום ולחבק עמודים), שתחייה באושר בעושר ובהושר עד עצם היום הזה, ועד עצם היום הבא והבא (עד 120 קיצר). מזל טוב!
>  יואב נפתלי

&#x202b;
מזל טוב שרמן, מקווה שנהנת מהctf למרות שלא יצא לי לתרום לו ממש
> יהונתן חרמץ

&#x202b;
אזזזז הצלחת את הctf סיוט שעשינו לך אבל זה עוד לא נגמר! הנה הflag האחרון:   
SherCTF{HaPpy_BirTHdAy}   
&#x202b;
שיהיה במזל טוב, 18 זה לא צחוק (מניסיון זה לא כזה וואו אז יש מצב שזה כן צחוק) שתזכה לחיים מלאים בשמחה, באושר, ובכיפות.    
&#x202b;
שתשאר חכם, מצחיק, צדיק, ועם כתב יותר יפה משל נתן לנצח,    
&#x202b;
באהבה,    
&#x202b;
> ענבר   
&#x202b;
נ.ב. זה לא באמת flag, כן?

&#x202b;
מזל טוב שרמן! Sir kind sir
> אלירן

&#x202b;
שרמן שרמן, חברי הטוב לקליק האדום ולwitcher 3. מזל טוב על 18, עכשיו באופן חוקי אתה יכול לעשות שוטים של קליק עם וודקה (לא שיש לי ספק שאתה לא עושה את זה עכשיו, כי אתה רוסי וזה. בלי להיות גזען כמובן). אז הגעת לגיל המצוות וזה בר מצווה וזה. תמשיך לחבק עמודים,
&#x202b;
מחברך הטוב, 
> אופיר

&#x202b;
שרמי חברצ יקר שלי, מלא מלא מזל טוב, אוהבת מלאאא🖤🦆
> ספיר

&#x202b;
לרון היקר הרבה מזל טוב ליום הולדתך
&#x202b;   
מאחל לך להמשיך להיות תותח בקורסים ובן אדם אדיב ונחמד שאני מחבב מאוד
&#x202b;  
דבר איתי אם בא לך קליק🤤 
&#x202b;   
תמשיך לחבק עמודים🙃 
> שחר מאיר

&#x202b;
מזל טוב אתה אחלה ילד תמשיך להיות אחלה בחלה ותהנה מהחיים ומהלימודים. בהצלחה בהמשך התואר.
> טל "אדוני" נקר

&#x202b;
שרמן המלךךךךך👑😍  
&#x202b;
מזל טוב ליומו🥳🥳🥳  
&#x202b;
עד 0️⃣2️⃣1️⃣ (בהקסה כמובן)  
&#x202b;
שתמשיך לפרק CTFs כמו שפירקת את זה (אם לא הצלחת אתה לא אמור לקרוא את זה עכשיו, לא?🤔)  
&#x202b;
שתמשיך להיות אחראי הקורס הכי טוב שיש (חוץ ממני כמובן😌)  
&#x202b;
תמשיך להיות יותר חכם מהבינה המלאכותית שאתה יוצר (קח את זה כמחמאה, לא בכיוון ההפוך נו) 🤓  
&#x202b;
ותזכיר לי לקנות לך קליק אדום כשחוזרים 🍫 (איך אין אימוג'י לקליק?)  
&#x202b;
אוהב❤️❤️❤️   
> עמית   
> הבן   
> מילוא   
> לא ניר   
> הבנת קיצר

------

## Write up

You were givan a zip with an image.

At first you needed to extract Omri's file from the given image using `binwalk`. The file was concatenated using simple python code to the image.

Then you've reached omri's pwn challenge (kind of misc) - you were asked to insert a numerical token. if you tried few numbers you seen it prints gibrish. if you disassemble / decompile the ELF, you see it init srand with your input number, and then prints about 50 times characters from array[rand()].
you've hinted that you are with us quite an eppoch - a reference to the epoch time system - how many seconds elapsed from 1.1.1970. so when you entered this number corresponding with the date of your birthday - 23.4.2001 (using online converter - any time that day), you''ve got the flag: SHERCTF{b3st_tim3s: https://bit.ly/34Xq5qq}


Then you've reached the Tetris reverse challenge. you've got a tetris game. you've asked only to find out how the Drawer process (gui) and the Tetris process (keyboard input), communicates - when you reversed it, you saw its through signals. you've checked the /proc/{Drawer_pid}/status file, in this line:
SigCgt: 0000000000022800
the binary mask that tells you which signal handlers exsists for that process - when binary[i] == 1 iff theres an handler.
and you saw that there is a signal handler for signal num 18, (SIGCONT), as your age.
when you sent this signal to Drawer process, with
kill -18 {Drawer_pid}
each kill added a letter of the flag to the tetris gui, until finally:
SHERCTF{here_1s_an0th3r_5igna1: {https://bit.ly/2VuTrcU}


Then you have reached Tal's challange - thousands upon thousands of files and directories. You could find a hint by [searching](https://winaero.com/blog/find-files-containing-text-linux/) "SHERCTF". The correct file was at the directories `2/3/4/0/2/`! In all the other files you had random lines from random wikipidia values.

But the file content was weird, it was [brainfuck](https://en.wikipedia.org/wiki/Brainfuck), the result was a clue for you to go to the Dr. Erez Shiner's class מבנים אלגבריים lecure 7 about RSA.

In the comments if you press sort by new you will see `N`, `e`, and `c`.   
There you needed to notice that `N` was to small for RSA so you can break it to `p` and `q` using [Integer factorization calculator](https://www.alpertron.com.ar/ECM.HTM). After parsing the result with [long_to_bytes()](https://pythonhosted.org/pycrypto/Crypto.Util.number-module.html) you got the final link.

And here you are!

------
### יוצרים

חלק | יוצרים
-----|-----
הודעה | יואב ועמית
רעיון | מילוא
Image | ליפשיץ
Pwn | עומרי
Reversing | עומרי
Misc | טל
Rsa | עמית
אתר | ליפשיץ
